cube(`event_vulnerability`, {
  sql: `select distinct sen.gid, ecv.* from event_comp_vulnerability as ecv, sensor as sen, asset as ass  where sen.sensor_id = ecv.sensor_id and ecv.sensor_id = ass.sensor_id and ecv.asset_mac = ass.mac`,

  joins: {

  },

  measures: {
    count: {
      type: `count`,
      drillMembers: []
    }
  },

  dimensions: {
    gid: {
      sql: `gid`,
      type: `number`
    },

    category: {
      sql: `category`,
      type: `number`
    },

    readTime: {
      sql: `read_time`,
      type: `time`
    },

    end_time: {
      sql: `end_time`,
      type: `time`
    },

    vulnerability_code: {
      sql: `vulnerability_code`,
      type: `string`
    },

    action: {
      sql: `action`,
      type: `string`
    },

    sensorId: {
      sql: `sensor_id`,
      type: `string`
    },

    severity: {
      sql: `severity`,
      type: `number`
    },

    asset_mac: {
      sql: `asset_mac`,
      type: `string`
    }
  },
  refreshKey: {
      sql: `SELECT FLOOR(EXTRACT(EPOCH FROM NOW()) / 10)`
  }
});
